<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:Moodly"
             x:Class="Moodly.MainPage"
             Title="Moodly">

    <!--Ресурсы-->
    <ContentPage.Resources>
        <ResourceDictionary>
            <local:EmojiToColorConverter x:Key="EmojiToColorConverter"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <!--Разделение на строки-->
    <Grid Padding="20" RowSpacing="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!--Панель-->
        <VerticalStackLayout Grid.Row="0" Spacing="15" HorizontalOptions="Center" WidthRequest="950">
            <Label Text="Как вы себя чувствуете?" FontSize="18" HorizontalOptions="Center"/>
            <Label Text="Ваши эмоции заслуживают быть записанными." FontSize="10" HorizontalOptions="Center"/>

            <Picker x:Name="EmojiPicker" Title="Выберите эмодзи:" HorizontalOptions="Center" WidthRequest="900">
                <Picker.Items>
                    <x:String>😊</x:String>
                    <x:String>😐</x:String>
                    <x:String>😔</x:String>
                </Picker.Items>
            </Picker>

            <Entry x:Name="NoteEntry" Placeholder="Напишите заметку о своём состоянии (до 200 символов)" MaxLength="200" HorizontalOptions="Center" WidthRequest="900"/>
            <Button x:Name="OnSave" Text="Сохранить" Clicked="OnSave_Clicked" BackgroundColor="#4CAF50" TextColor="White" HorizontalOptions="Center" WidthRequest="250" HeightRequest="50"/>
            <Label Text="Последние ваши записи:" FontSize="16" Margin="0, 10, 0, 0" WidthRequest="1000"/>
        </VerticalStackLayout>

        <!-- Список занимает всё доступное место и скроллится -->
        <ListView x:Name="MoodList"
                  Grid.Row="1"
                  HasUnevenRows="True"
                  Margin="0, 10, 0, 0"
                  VerticalOptions="Start"
                  HorizontalOptions="Center"
                  SeparatorVisibility="Default"
                  WidthRequest="1000">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <ViewCell>
                        <ViewCell.ContextActions>
                            <MenuItem Text="Удалить" Clicked="OnDelete_Clicked" CommandParameter="{Binding .}" IsDestructive="True" />
                        </ViewCell.ContextActions>
                        <StackLayout Orientation="Horizontal" Padding="10" BackgroundColor="{Binding Emoji, Converter={StaticResource EmojiToColorConverter}}">
                            <Label Text="{Binding Emoji}" FontSize="20" />
                            <Label Text="{Binding Date, StringFormat='{0:dd.MM}'}" FontSize="14" Margin="10,0,0,0"/>
                            <Label Text="{Binding Note}" FontSize="14" Margin="10,0,0,0"/>
                        </StackLayout>
                    </ViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!--Версия приложения-->
        <Label x:Name="VersionLabel" Grid.Row="2" FontSize="12" HorizontalTextAlignment="End" Margin="0,10,0,0"/>
    </Grid>
</ContentPage>
